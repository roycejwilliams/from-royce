[debug] [2025-03-24T19:07:26.954Z] ----------------------------------------------------------------------
[debug] [2025-03-24T19:07:26.955Z] Command:       /Users/roycewilliams/.nvm/versions/node/v22.14.0/bin/node /Users/roycewilliams/.nvm/versions/node/v22.14.0/bin/firebase deploy --only functions:nextApp --project from-royce --debug
[debug] [2025-03-24T19:07:26.955Z] CLI Version:   13.35.1
[debug] [2025-03-24T19:07:26.955Z] Platform:      darwin
[debug] [2025-03-24T19:07:26.955Z] Node Version:  v22.14.0
[debug] [2025-03-24T19:07:26.955Z] Time:          Mon Mar 24 2025 12:07:26 GMT-0700 (Pacific Daylight Time)
[debug] [2025-03-24T19:07:26.955Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-03-24T19:07:27.017Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-03-24T19:07:27.018Z] > authorizing via signed-in user (roycewilliamsj@gmail.com)
[debug] [2025-03-24T19:07:27.018Z] [iam] checking project from-royce for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-03-24T19:07:27.018Z] Checked if tokens are valid: false, expires at: 1742843780516
[debug] [2025-03-24T19:07:27.018Z] Checked if tokens are valid: false, expires at: 1742843780516
[debug] [2025-03-24T19:07:27.019Z] > refreshing access token with scopes: []
[debug] [2025-03-24T19:07:27.019Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2025-03-24T19:07:27.019Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-03-24T19:07:27.154Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2025-03-24T19:07:27.155Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-03-24T19:07:27.168Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/from-royce:testIamPermissions [none]
[debug] [2025-03-24T19:07:27.168Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/from-royce:testIamPermissions x-goog-quota-user=projects/from-royce
[debug] [2025-03-24T19:07:27.168Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/from-royce:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-24T19:07:27.297Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/from-royce:testIamPermissions 200
[debug] [2025-03-24T19:07:27.298Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/from-royce:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-24T19:07:27.298Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.298Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.298Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/from-royce/serviceAccounts/from-royce@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-03-24T19:07:27.299Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/from-royce/serviceAccounts/from-royce@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-03-24T19:07:27.471Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/from-royce/serviceAccounts/from-royce@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-03-24T19:07:27.472Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/from-royce/serviceAccounts/from-royce@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'from-royce'...
[info] 
[info] i  deploying functions 
[debug] [2025-03-24T19:07:27.475Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.475Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.475Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/from-royce [none]
[debug] [2025-03-24T19:07:27.598Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/from-royce 200
[debug] [2025-03-24T19:07:27.598Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/from-royce {"projectNumber":"1042271682270","projectId":"from-royce","lifecycleState":"ACTIVE","name":"from-royce","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-02-01T17:25:21.500891Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[debug] [2025-03-24T19:07:27.599Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.599Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.599Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.599Z] Checked if tokens are valid: true, expires at: 1742846846155
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[debug] [2025-03-24T19:07:27.599Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.599Z] Checked if tokens are valid: true, expires at: 1742846846155
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-03-24T19:07:27.599Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.599Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:27.599Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/cloudfunctions.googleapis.com [none]
[debug] [2025-03-24T19:07:27.599Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/from-royce
[debug] [2025-03-24T19:07:27.600Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/runtimeconfig.googleapis.com [none]
[debug] [2025-03-24T19:07:27.600Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/from-royce
[debug] [2025-03-24T19:07:27.601Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/cloudbuild.googleapis.com [none]
[debug] [2025-03-24T19:07:27.601Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/cloudbuild.googleapis.com x-goog-quota-user=projects/from-royce
[debug] [2025-03-24T19:07:27.602Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/artifactregistry.googleapis.com [none]
[debug] [2025-03-24T19:07:27.602Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/artifactregistry.googleapis.com x-goog-quota-user=projects/from-royce
[debug] [2025-03-24T19:07:28.196Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/cloudfunctions.googleapis.com 200
[debug] [2025-03-24T19:07:28.196Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2025-03-24T19:07:28.196Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/artifactregistry.googleapis.com 200
[debug] [2025-03-24T19:07:28.196Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2025-03-24T19:07:28.196Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/runtimeconfig.googleapis.com 200
[debug] [2025-03-24T19:07:28.196Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/runtimeconfig.googleapis.com [omitted]
[debug] [2025-03-24T19:07:28.196Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/cloudbuild.googleapis.com 200
[debug] [2025-03-24T19:07:28.196Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/from-royce/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2025-03-24T19:07:28.197Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:28.197Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:28.197Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/from-royce/adminSdkConfig [none]
[debug] [2025-03-24T19:07:28.502Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/from-royce/adminSdkConfig 200
[debug] [2025-03-24T19:07:28.503Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/from-royce/adminSdkConfig {"projectId":"from-royce","storageBucket":"from-royce.firebasestorage.app"}
[debug] [2025-03-24T19:07:28.504Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:28.504Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:28.504Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/from-royce/configs [none]
[debug] [2025-03-24T19:07:28.740Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/from-royce/configs 200
[debug] [2025-03-24T19:07:28.741Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/from-royce/configs {}
[debug] [2025-03-24T19:07:28.742Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-03-24T19:07:29.016Z] > [functions] package.json contents: {
  "name": "functions",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": {
    "build": "echo 'nothing to build for functions'",
    "serve": "firebase emulators:start --only functions",
    "deploy": "firebase deploy --only functions",
    "lint": "echo 'no linting setup'"
  },
  "author": "",
  "license": "ISC",
  "dependencies": {
    "cors": "^2.8.5",
    "express": "^4.21.2",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^4.9.0",
    "next": "^15.2.3",
    "nodemon": "^3.1.9",
    "pg": "^8.14.1",
    "react": "^19.0.0",
    "react-dom": "^19.0.0"
  },
  "devDependencies": {
    "@types/cors": "^2.8.17",
    "@types/express": "^5.0.0"
  },
  "engines": {
    "node": "20"
  },
  "keywords": [],
  "description": ""
}
[debug] [2025-03-24T19:07:29.016Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[info] i  functions: You are using a version of firebase-functions SDK (4.9.0) that does not have support for the newest Firebase Extensions features. Please update firebase-functions SDK to >=5.1.0 to use them correctly 
[debug] [2025-03-24T19:07:29.016Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-03-24T19:07:29.020Z] Found firebase-functions binary at '/Users/roycewilliams/from-royce/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8308

[debug] [2025-03-24T19:07:29.230Z] Got response from /__/functions.yaml {"endpoints":{},"specVersion":"v1alpha1","requiredAPIs":[]}
[error] /Users/roycewilliams/from-royce/functions/node_modules/next/dist/lib/find-pages-dir.js:42
        throw Object.defineProperty(new Error("> Couldn't find any `pages` or `app` directory. Please create one under the project root"), "__NEXT_ERROR_CODE", {
                                    ^

Error: > Couldn't find any `pages` or `app` directory. Please create one under the project root
    at findPagesDir (/Users/roycewilliams/from-royce/functions/node_modules/next/dist/lib/find-pages-dir.js:42:37)
    at initialize (/Users/roycewilliams/from-royce/functions/node_modules/next/dist/server/lib/router-server.js:124:69)
    at async NextCustomServer.prepare (/Users/roycewilliams/from-royce/functions/node_modules/next/dist/server/next.js:276:28)

Node.js v22.14.0

[debug] [2025-03-24T19:07:29.270Z] Failed to call quitquitquit. This often means the server failed to start request to http://localhost:8308/__/quitquitquit failed, reason: read ECONNRESET {"message":"request to http://localhost:8308/__/quitquitquit failed, reason: read ECONNRESET","type":"system","errno":"ECONNRESET","code":"ECONNRESET"}
[debug] [2025-03-24T19:07:29.271Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:29.271Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:29.271Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/from-royce/locations/-/functions [none]
[debug] [2025-03-24T19:07:29.815Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/from-royce/locations/-/functions 200
[debug] [2025-03-24T19:07:29.816Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/from-royce/locations/-/functions {}
[debug] [2025-03-24T19:07:29.816Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:29.816Z] Checked if tokens are valid: true, expires at: 1742846846155
[debug] [2025-03-24T19:07:29.817Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/from-royce/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-03-24T19:07:30.260Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/from-royce/locations/-/functions 200
[debug] [2025-03-24T19:07:30.260Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/from-royce/locations/-/functions {}
[debug] [2025-03-24T19:07:30.267Z] Total Function Deployment time: 0
[debug] [2025-03-24T19:07:30.267Z] 0 Functions Deployed
[debug] [2025-03-24T19:07:30.267Z] 0 Functions Errored
[debug] [2025-03-24T19:07:30.267Z] 0 Function Deployments Aborted
[debug] [2025-03-24T19:07:30.267Z] Average Function Deployment time: NaN
[info] i  functions: cleaning up build files... 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/from-royce/overview
